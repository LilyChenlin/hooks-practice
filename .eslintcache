[{"/Users/chenlili/study/High delayed gratification/ts-with-react/src/index.tsx":"1","/Users/chenlili/study/High delayed gratification/ts-with-react/src/todoInput.tsx":"2","/Users/chenlili/study/High delayed gratification/ts-with-react/src/todoList.js":"3","/Users/chenlili/study/High delayed gratification/ts-with-react/src/api.js":"4","/Users/chenlili/study/High delayed gratification/ts-with-react/src/hooks.js":"5"},{"size":2379,"mtime":1612166530435,"results":"6","hashOfConfig":"7"},{"size":649,"mtime":1612082811180,"results":"8","hashOfConfig":"7"},{"size":1537,"mtime":1612168211757,"results":"9","hashOfConfig":"7"},{"size":2064,"mtime":1612168488872,"results":"10","hashOfConfig":"7"},{"size":1657,"mtime":1612147503232,"results":"11","hashOfConfig":"7"},{"filePath":"12","messages":"13","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"13ldyd8",{"filePath":"14","messages":"15","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"16"},{"filePath":"17","messages":"18","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"19","messages":"20","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"21","messages":"22","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"23","usedDeprecatedRules":"24"},"/Users/chenlili/study/High delayed gratification/ts-with-react/src/index.tsx",[],"/Users/chenlili/study/High delayed gratification/ts-with-react/src/todoInput.tsx",[],["25","26"],"/Users/chenlili/study/High delayed gratification/ts-with-react/src/todoList.js",[],"/Users/chenlili/study/High delayed gratification/ts-with-react/src/api.js",[],"/Users/chenlili/study/High delayed gratification/ts-with-react/src/hooks.js",["27","28"],"import {useState, useEffect} from 'react';\n\nexport const useRequest = (fn, dependencies, defaultValue = []) => {\n    const [data, setData] = useState(defaultValue);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState(false);\n\n    const request = () => {\n        // 定义cancel标志位\n        let cancel = false;\n        // 开始请求\n        setLoading(true); // 展示loading...\n        fn().then(res => {\n            if(!cancel) {\n                setData(res)\n            } else {\n                const {tab} = res;\n                console.log(`request with ${tab} canceled`)\n            }\n        }).catch((error) => {\n            if(!cancel) {\n                setError(error)\n            }\n        }).finally(() => {\n            if (!cancel) {\n                setLoading(false)\n            }\n        })\n\n\n        return () => {\n            cancel = true;\n        }\n    }\n\n    // 每次dependencies发生变化的时候 执行这个effect\n    // 在useEffect传入的函数，返回一个取消请求的函数\n    // 这样在下一次调用这个useEffect时，会先取消掉上一次的请求。解决频繁切换tab产生的脏数据\n    useEffect(() => {\n        const cancelRequest = request();\n        return () => {\n            cancelRequest()\n        }\n    }, dependencies)\n\n    return { data, setData, loading, error, request };\n}\n\nexport const useWithLoading = (fn) => {\n    const [loading, setLoading] = useState(false);\n    const func = (...args) => {\n        setLoading(true);\n        return fn(...args).finally(() => {\n            setLoading(false);\n        });\n    }\n    return {loading, func}\n}",["29","30"],{"ruleId":"31","replacedBy":"32"},{"ruleId":"33","replacedBy":"34"},{"ruleId":"35","severity":1,"message":"36","line":44,"column":8,"nodeType":"37","endLine":44,"endColumn":20},{"ruleId":"35","severity":1,"message":"38","line":44,"column":8,"nodeType":"37","endLine":44,"endColumn":20,"suggestions":"39"},{"ruleId":"31","replacedBy":"32"},{"ruleId":"33","replacedBy":"34"},"no-native-reassign",["40"],"no-negated-in-lhs",["41"],"react-hooks/exhaustive-deps","React Hook useEffect was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","Identifier","React Hook useEffect has a missing dependency: 'request'. Either include it or remove the dependency array.",["42"],"no-global-assign","no-unsafe-negation",{"desc":"43","fix":"44"},"Update the dependencies array to be: [request]",{"range":"45","text":"46"},[1159,1171],"[request]"]